#!/usr/bin/env bash
# dashboard-delete: Delete a dashboard
#
# Usage: dashboard-delete <deployment> <id>
#
# ⚠️  This is irreversible! Axiom cannot restore deleted dashboards.
#
# Examples:
#   dashboard-delete prod abc123

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

DEPLOYMENT="${1:-}"
ID="${2:-}"

if [[ -z "$DEPLOYMENT" || -z "$ID" ]]; then
    echo "Usage: dashboard-delete <deployment> <id>" >&2
    exit 1
fi

# Confirm
read -p "Delete dashboard $ID? This cannot be undone. [y/N] " -n 1 -r
echo
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    echo "Cancelled"
    exit 0
fi

"$SCRIPT_DIR/axiom-api" "$DEPLOYMENT" DELETE "/internal/dashboards/$ID"
echo "Deleted: $ID"
